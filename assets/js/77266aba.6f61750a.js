"use strict";(self.webpackChunksnowflake_promise_website=self.webpackChunksnowflake_promise_website||[]).push([[6861],{850:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"api-reference","title":"API Reference","description":"The promisifyConnection Function","source":"@site/docs/api-reference.mdx","sourceDirName":".","slug":"/api-reference","permalink":"/snowflake-promise/docs/api-reference","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"API Reference"},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/snowflake-promise/docs/getting-started"},"next":{"title":"Examples","permalink":"/snowflake-promise/docs/examples/"}}');var s=i(4848),c=i(8453);const o={sidebar_position:3,title:"API Reference"},r=void 0,d={},a=[{value:"The <code>promisifyConnection</code> Function",id:"the-promisifyconnection-function",level:2},{value:"What <code>promisifyConnection</code> Does",id:"what-promisifyconnection-does",level:3},{value:"<code>Connection</code> Methods That Are Promisified by This Library",id:"connection-methods-that-are-promisified-by-this-library",level:2},{value:"<code>connect</code>",id:"connect",level:3},{value:"TypeScript signature",id:"typescript-signature",level:4},{value:"Usage",id:"usage",level:4},{value:"<code>connectAsync</code>",id:"connectasync",level:3},{value:"TypeScript signature",id:"typescript-signature-1",level:4},{value:"Usage",id:"usage-1",level:4},{value:"<code>destroy</code>",id:"destroy",level:3},{value:"TypeScript signature",id:"typescript-signature-2",level:4},{value:"Usage",id:"usage-2",level:4},{value:"<code>execute</code>",id:"execute",level:3},{value:"TypeScript signature",id:"typescript-signature-3",level:4},{value:"Usage",id:"usage-3",level:4},{value:"<code>fetchResult</code>",id:"fetchresult",level:3},{value:"TypeScript signature",id:"typescript-signature-4",level:4},{value:"Usage",id:"usage-4",level:4},{value:"<code>RowStatement</code> Methods That Are Promisified by This Library",id:"rowstatement-methods-that-are-promisified-by-this-library",level:2},{value:"<code>cancel</code>",id:"cancel",level:3},{value:"TypeScript signature",id:"typescript-signature-5",level:4},{value:"Usage",id:"usage-5",level:4}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h2,{id:"the-promisifyconnection-function",children:["The ",(0,s.jsx)(n.code,{children:"promisifyConnection"})," Function"]}),"\n",(0,s.jsxs)(n.p,{children:["This library\u2019s main function is ",(0,s.jsx)(n.code,{children:"promisifyConnection"})," which augments a Snowflake ",(0,s.jsx)(n.code,{children:"Connection"})," to allow using Promises. You won\u2019t need any other functions from this library."]}),"\n",(0,s.jsx)(n.p,{children:"Once you\u2019ve promisifed a connection, everything else that you do with Snowflake is done using the standard Snowflake SDK methods, except that you are able to use Promises to handle asynchronous operations."}),"\n",(0,s.jsxs)(n.h3,{id:"what-promisifyconnection-does",children:["What ",(0,s.jsx)(n.code,{children:"promisifyConnection"})," Does"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"promisifyConnection"})," takes a Snowflake ",(0,s.jsx)(n.code,{children:"Connection"})," object and returns a new ",(0,s.jsx)(n.code,{children:"PromisifiedConnection"})," object with the same methods, but adding support for Promises."]}),"\n",(0,s.jsxs)(n.p,{children:["The following ",(0,s.jsx)(n.code,{children:"Connection"})," methods are augmented with Promise support:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#connect",children:(0,s.jsx)(n.code,{children:"connect"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#connectasync",children:(0,s.jsx)(n.code,{children:"connectAsync"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#destroy",children:(0,s.jsx)(n.code,{children:"destroy"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#execute",children:(0,s.jsx)(n.code,{children:"execute"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#fetchresult",children:(0,s.jsx)(n.code,{children:"fetchResult"})})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Any ",(0,s.jsx)(n.code,{children:"RowStatement"})," objects returned from promisified methods will have Promise support added to the following method:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#cancel",children:(0,s.jsx)(n.code,{children:"cancel"})})}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"connection-methods-that-are-promisified-by-this-library",children:[(0,s.jsx)(n.code,{children:"Connection"})," Methods That Are Promisified by This Library"]}),"\n",(0,s.jsx)(n.p,{children:"The methods below are enhanced with Promise support while still allowing callback usage."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"The Promise functionality activates automatically when no callback is provided. If a callback is provided, the original, non-promisified, callback-based method is called."})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"connect",children:(0,s.jsx)(n.code,{children:"connect"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Link: ",(0,s.jsx)(n.a,{href:"https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-connect#creating-a-single-connection",children:"Snowflake SDK Documentation for Connections"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\nconnect(callback: ConnectionCallback): void;\n\n// promisified signature\nconnect(): Promise<Connection>;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:["After creating a ",(0,s.jsx)(n.code,{children:"Connection"}),", use its ",(0,s.jsx)(n.code,{children:"connect"})," method to connect to Snowflake."]}),"\n",(0,s.jsxs)(n.p,{children:["The standard SDK ",(0,s.jsx)(n.code,{children:"connect"})," method accepts a callback function for connection readiness. Because the callback function may not be in the same scope as the calling code, when using callbacks it may be difficult to know when a connection is ready to use. The ",(0,s.jsx)(n.code,{children:"connection.isValidAsync()"})," method can be used to check connection status."]}),"\n",(0,s.jsxs)(n.p,{children:["When using Promises, you generally won\u2019t need to call ",(0,s.jsx)(n.code,{children:"connection.isValidAsync()"})," because once the ",(0,s.jsx)(n.code,{children:"Promise"})," resolves, the connection is ready."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"connectasync",children:(0,s.jsx)(n.code,{children:"connectAsync"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Link: ",(0,s.jsx)(n.a,{href:"https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-connect#creating-a-single-connection",children:"Snowflake SDK Documentation for Connections"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature-1",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\nconnectAsync(callback: ConnectionCallback): Promise<void>;\n\n// promisified signature\nconnectAsync(): Promise<Connection>;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage-1",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:["For authentication types like browser-based SSO (",(0,s.jsx)(n.code,{children:"EXTERNALBROWSER"}),"), you need to use ",(0,s.jsx)(n.code,{children:"connectAsync"})," instead of ",(0,s.jsx)(n.code,{children:"connect"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["It works the same way as the standard ",(0,s.jsx)(n.code,{children:"connect"})," method."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"destroy",children:(0,s.jsx)(n.code,{children:"destroy"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Link: ",(0,s.jsx)(n.a,{href:"https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-connect#terminating-a-connection",children:"Snowflake SDK documentation for terminating a connection"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature-2",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\ndestroy(fn: ConnectionCallback): void;\n\n// promisified signature\ndestroy(): Promise<void>;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage-2",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:["Use the ",(0,s.jsx)(n.code,{children:"destroy"})," method to end a session and destroy a connection, without waiting for any pending operations to complete."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"execute",children:(0,s.jsx)(n.code,{children:"execute"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Link: ",(0,s.jsx)(n.a,{href:"https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-execute",children:"Snowflake SDK Documentation for Executing SQL Statements"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature-3",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\nexecute(options: StatementOption): RowStatement | FileAndStageBindStatement;\n\n// promisified signature\nexecute<RowType>(\n  options: StatementOptionWithoutCallback,\n): { statement: RowStatement; resultsPromise: Promise<RowType[]> };\n\n// Note: FileAndStageBindStatement is a subclass of RowStatement.\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage-3",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"execute"})," is the main method for executing SQL statements in the Snowflake SDK."]}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"execute"})," to run SQL queries. It returns an object containing both a ",(0,s.jsx)(n.code,{children:"Statement"})," and a Promise for the results:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const { statement, resultsPromise } = await connection.execute({sqlText });\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can use the ",(0,s.jsx)(n.code,{children:"statement"})," object to manage or cancel long-running queries."]}),"\n",(0,s.jsxs)(n.p,{children:["To get the actual query results, you need to await the ",(0,s.jsx)(n.code,{children:"resultsPromise"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const results = await resultsPromise;\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Why doesn\u2019t the ",(0,s.jsx)(n.code,{children:"execute"})," method directly return the results?"]})}),(0,s.jsxs)(n.p,{children:["Instead of returning the results directly, the ",(0,s.jsx)(n.code,{children:"execute"})," method returns both the Statement object and a ",(0,s.jsx)(n.em,{children:"Promise"})," for the results (instead of the results directly). This gives you more control: you can manage or cancel long-running queries before awaiting the results."]}),(0,s.jsx)(n.p,{children:"This approach preserves all the functionality of the underlying Snowflake SDK."})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"fetchresult",children:(0,s.jsx)(n.code,{children:"fetchResult"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Link: None. Not documented in the Snowflake SDK."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature-4",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\nfetchResult(options: StatementOption): RowStatement | FileAndStageBindStatement;\n\n// promisified signature\nfetchResult<RowType>(\n  options: StatementOptionWithoutCallback,\n): { statement: RowStatement; resultsPromise: Promise<RowType[]> };\n\n// Note: FileAndStageBindStatement is a subclass of RowStatement.\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage-4",children:"Usage"}),"\n",(0,s.jsx)(n.p,{children:"Not documented."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"rowstatement-methods-that-are-promisified-by-this-library",children:[(0,s.jsx)(n.code,{children:"RowStatement"})," Methods That Are Promisified by This Library"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"connection.execute"})," returns a ",(0,s.jsx)(n.code,{children:"RowStatement"})," object (and a ",(0,s.jsx)(n.code,{children:"resultsPromise"}),"). The ",(0,s.jsx)(n.code,{children:"RowStatement"})," that is returned is promisified. The only method that is promisified is ",(0,s.jsx)(n.code,{children:"cancel"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"cancel",children:(0,s.jsx)(n.code,{children:"cancel"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Link: ",(0,s.jsx)(n.a,{href:"https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-execute#canceling-statements",children:"Snowflake SDK documentation for canceling a statement"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"typescript-signature-5",children:"TypeScript signature"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// original SDK signature\ncancel(callback?: StatementCallback): void;\n\n// promisified signature\ncancel(): Promise<void>;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage-5",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:["Use the ",(0,s.jsx)(n.code,{children:"cancel"})," method to cancel a running statement."]}),"\n",(0,s.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(6540);const s={},c=t.createContext(s);function o(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);